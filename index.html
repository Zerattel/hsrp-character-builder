<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –ü–µ—Ä—Å–æ–Ω–∞–∂–∞</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Exo+2:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    
    <style>
        /* === –ë–ê–ó–û–í–´–ï –°–¢–ò–õ–ò === */
        :root {
            --bg-color: #000000;
            --text-color: #ffffff;
            --accent-green: #00ff41;
            --accent-red: #ff003c;
            --card-width: 275px;
            --card-height: 400px;
        }

        body {
            margin: 0;
            padding: 0;
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: "Exo 2", sans-serif;
            overflow-x: hidden;
            overflow-y: hidden; 
        }

        h1, h2, h3 { text-transform: uppercase; letter-spacing: 2px; }
        
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #111; }
        ::-webkit-scrollbar-thumb { background: #fff; border-radius: 4px; }

        /* === –°–ï–ö–¶–ò–ò === */
        section {
            min-height: 100vh;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            padding-top: 50px;
            box-sizing: border-box;
            opacity: 0.3;
            transition: opacity 0.5s ease;
            position: relative;
            border-bottom: 1px dashed #333;
        }

        section.active {
            opacity: 1;
        }

        .container {
            width: 90%;
            max-width: 1600px;
            z-index: 2;
        }

        /* === –≠–õ–ï–ú–ï–ù–¢–´ –î–ò–ó–ê–ô–ù–ê === */
        .bg-layer {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background-size: cover;
            background-position: top left;
            z-index: 0;
            opacity: 0.2;
            pointer-events: none;
            filter: grayscale(100%);
        }

        input[type="text"] {
            background: transparent;
            border: 2px solid #fff;
            color: #fff;
            padding: 15px;
            font-family: "Exo 2", sans-serif;
            font-size: 1.2rem;
            outline: none;
            width: 300px;
            text-align: center;
            transition: all 0.3s ease;
        }

        input[type="text"]:focus { box-shadow: 0 0 15px rgba(255, 255, 255, 0.5); }
        input[type="text"].success {
            border-color: var(--accent-green);
            color: var(--accent-green);
            box-shadow: 0 0 15px var(--accent-green);
        }

        .btn-main {
            background: rgba(0,0,0,0.5);
            border: 2px solid #fff;
            color: #fff;
            padding: 10px 30px;
            margin-top: 20px;
            cursor: pointer;
            text-transform: uppercase;
            font-weight: bold;
            font-family: "Exo 2";
            transition: 0.3s;
            clip-path: polygon(10% 0, 100% 0, 100% 70%, 90% 100%, 0 100%, 0 30%);
        }

        .btn-main:hover {
            background: #fff;
            color: #000;
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.8);
        }

        /* === HAZARD LINE === */
        .hazard-container {
            width: 300px;
            height: 10px;
            border: 1px solid #fff;
            margin-top: 20px;
            display: none;
            overflow: hidden;
        }

        .hazard-line {
            height: 100%;
            width: 0%;
            background: repeating-linear-gradient(45deg, #fff, #fff 10px, #000 10px, #000 20px);
            transition: width 2s ease-in-out;
        }

        /* === –ö–ê–†–¢–û–ß–ö–ò === */
        .cards-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
            width: 100%;
            margin-top: 30px;
        }

        .card {
            width: var(--card-width);
            height: var(--card-height);
            border: 1px solid #fff;
            background-color: rgba(0, 0, 0, 0.4); /* –ü–†–û–ó–†–ê–ß–ù–û–°–¢–¨ */
            display: flex;
            flex-direction: column;
            position: relative;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.3s;
            overflow: hidden;
            backdrop-filter: blur(2px);
        }

        .card:hover {
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.4);
            transform: translateY(-5px);
            border-color: #fff;
        }

        .card.selected {
            border-color: var(--accent-green);
            box-shadow: 0 0 20px rgba(0, 255, 65, 0.5);
        }

        .card.wide {
            /* –£–º–µ–Ω—å—à–µ–Ω–∞ —à–∏—Ä–∏–Ω–∞ —á—Ç–æ–±—ã –≤–ª–µ–∑–∞–ª–æ –≤ 1920 */
            width: calc(var(--card-width) * 1.2); 
        }

        .card-bg {
            position: absolute; top: 0; left: 0; right: 0; bottom: 0;
            background-size: cover; opacity: 0.3; z-index: 0;
        }

        .card-header-img {
            height: 33%; width: 100%;
            background-size: cover; background-position: center;
            z-index: 1; border-bottom: 1px solid #fff;
        }

        .card-content {
            padding: 15px; z-index: 1; flex-grow: 1;
            display: flex; flex-direction: column;
        }

        .card-title { font-size: 1.5rem; font-weight: 800; margin-bottom: 10px; }
        .card-desc { font-size: 0.9rem; color: #ccc; line-height: 1.4; }

        /* === –†–ê–°–ü–†–ï–î–ï–õ–ï–ù–ò–ï (Stats) === */
        .stats-wrapper {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            width: 100%;
            margin-top: 20px;
        }

        .stat-column {
            width: 45%;
            min-width: 400px;
            border: 1px solid #555;
            padding: 20px;
            background: rgba(0, 0, 0, 0.5); /* –ü–†–û–ó–†–ê–ß–ù–û–°–¢–¨ */
            margin-bottom: 20px;
            transition: border-color 0.3s;
            backdrop-filter: blur(5px);
        }
        
        .stat-column.balanced {
            border-color: var(--accent-green);
            box-shadow: 0 0 10px rgba(0, 255, 65, 0.2);
        }

        .pool-counter {
            text-align: center;
            font-size: 1.2rem;
            margin-bottom: 20px;
            border-bottom: 1px solid #fff;
            padding-bottom: 10px;
        }

        .stat-row { margin-bottom: 20px; }
        .stat-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px; }
        .stat-desc { font-size: 0.8rem; color: rgba(255,255,255,0.5); margin-bottom: 5px; }
        .stat-control { display: flex; align-items: center; justify-content: space-between; }

        .stat-bar { display: flex; gap: 2px; }
        .bar-segment { width: 20px; height: 20px; border: 1px solid #555; background: transparent; }
        .bar-segment.neg { background: var(--accent-red); border-color: var(--accent-red); }
        .bar-segment.pos { background: var(--accent-green); border-color: var(--accent-green); }
        .bar-segment.zero { background: #fff; border-color: #fff; }

        .stat-btn {
            background: transparent; border: 1px solid #fff; color: #fff;
            width: 30px; height: 30px; cursor: pointer; font-size: 1.2rem;
        }
        .stat-btn:hover { background: #fff; color: #000; }
        .stat-value-display { width: 30px; text-align: center; font-weight: bold; }

        /* –°–ü–ï–¶–ò–ê–õ–¨–ù–´–ï –ß–ï–ö–ë–û–ö–°–´ */
        .special-options {
            width: 100%;
            text-align: center;
            margin-top: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .checkbox-wrapper {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            user-select: none;
        }

        /* –•–∞—Ä–¥–∫–æ—Ä */
        .hardcore-label {
            color: var(--accent-red);
            font-family: 'Courier New', monospace;
            font-weight: bold;
            font-size: 0.9rem;
            opacity: 0.7;
            transition: 0.3s;
        }
        .checkbox-wrapper:hover .hardcore-label { opacity: 1; text-shadow: 2px 2px 0px #000; }
        
        /* –Ø –∑–Ω–∞—é —á—Ç–æ –¥–µ–ª–∞—é */
        .override-label {
            color: #666;
            font-size: 0.8rem;
            opacity: 0.5;
            transition: 0.3s;
        }
        .checkbox-wrapper:hover .override-label { opacity: 0.8; }


        .error-msg {
            color: var(--accent-red);
            font-weight: bold;
            margin-top: 10px;
            display: none;
            text-align: center;
            animation: blink 1s infinite;
        }
        @keyframes blink { 50% { opacity: 0.5; } }

        .btn-copy {
            background: var(--accent-green);
            color: #000;
            border: none;
            padding: 15px 40px;
            font-size: 1.5rem;
            cursor: pointer;
            margin-top: 30px;
            width: 100%;
            max-width: 500px;
            font-weight: bold;
        }
        .btn-copy:hover { box-shadow: 0 0 30px var(--accent-green); }
        .discord-link { display: block; margin-top: 15px; color: #fff; text-decoration: underline; font-size: 0.9rem; }

    </style>
</head>
<body>

<audio id="error-sound" src="https://github.com/Zerattel/hsrp-character-builder/raw/refs/heads/main/EVE-structure-warning.mp3"></audio>

<section id="section-intro" class="active">
    <div class="bg-layer" style="background-image: url('https://placehold.co/1920x1080/111/333?text=Intro+BG');"></div>
    <div class="container" style="text-align: center; margin-top: 10vh;">
        <img src="https://github.com/Zerattel/hsrp-character-builder/blob/main/hsrp-logo.png?raw=true" alt="Logo" style="margin-bottom: 20px; border: 1px solid #fff; background: rgba(0,0,0,0.5);">
        
        <h2>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –°–∏—Å—Ç–µ–º—É</h2>
        <p style="max-width: 600px; margin: 0 auto 30px auto;">
            –≠—Ç–æ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –¥–ª—è –Ω–∞—à–µ–π –≤—Å–µ–ª–µ–Ω–Ω–æ–π.
        </p>

        <div style="display: flex; flex-direction: column; align-items: center;">
            <p>–í–í–ï–î–ò–¢–ï –ò–ú–Ø –ü–ï–†–°–û–ù–ê–ñ–ê</p>
            <input type="text" id="input-name" placeholder="–ò–º—è –§–∞–º–∏–ª–∏—è">
            
            <button class="btn-main" onclick="submitName()">–ü–û–î–¢–í–ï–†–î–ò–¢–¨ –í–í–û–î</button>
            
            <div class="hazard-container" id="hazard-loader">
                <div class="hazard-line" id="hazard-bar"></div>
            </div>
        </div>
    </div>
</section>

<section id="section-belong">
    <div class="bg-layer" style="background-image: url('https://placehold.co/1920x1080/222/444?text=Belong+BG');"></div>
    <div class="container">
        <h1 style="text-align: center; border-bottom: 2px solid white; padding-bottom: 10px;">–í–´–ë–û–† –ü–†–û–ò–°–•–û–ñ–î–ï–ù–ò–Ø</h1>
        <div class="cards-grid" id="belong-grid"></div>
        <div style="text-align: center; width: 100%;">
            <button class="btn-main" onclick="submitBelong()">–ü–†–ò–ù–Ø–¢–¨ –í–´–ë–û–†</button>
        </div>
    </div>
</section>

<section id="section-class">
    <div class="bg-layer" style="background-image: url('https://placehold.co/1920x1080/333/555?text=Class+BG');"></div>
    <div class="container">
        <h1 style="text-align: center; border-bottom: 2px solid white; padding-bottom: 10px;">–í–´–ë–û–† –ö–õ–ê–°–°–ê</h1>
        <div class="cards-grid" id="class-grid"></div>
        <div style="text-align: center; width: 100%;">
            <button class="btn-main" onclick="submitClass()">–ü–†–ò–ù–Ø–¢–¨ –í–´–ë–û–†</button>
        </div>
    </div>
</section>

<section id="section-stats">
    <div class="bg-layer" id="stats-bg" style="background-image: url('https://placehold.co/1920x1080/000/333?text=Generic+Stats+BG');"></div>
    
    <div class="container">
        <div style="border: 1px solid #fff; padding: 20px; margin-bottom: 20px; background: rgba(0,0,0,0.6);">
            <h2 id="final-header" style="margin: 0; text-align: center;">–ò–ú–Ø | –ö–õ–ê–°–° | –ë–ï–õ–û–ù–ì</h2>
        </div>

        <div class="stats-wrapper">
            <div class="stat-column" id="col-phys">
                <div class="pool-counter">
                    –°–≤–æ–±–æ–¥–Ω—ã–µ –æ—á–∫–∏ (–§–∏–∑.): <span id="pool-phys-val">0</span>
                </div>
                <div id="phys-list"></div>
            </div>

            <div class="stat-column" id="col-skills">
                <div class="pool-counter">
                    –°–≤–æ–±–æ–¥–Ω—ã–µ –æ—á–∫–∏ (–ù–∞–≤—ã–∫–∏): <span id="pool-skills-val">0</span>
                </div>
                <div id="skills-list"></div>
            </div>
        </div>

        <div class="special-options">
            <label class="checkbox-wrapper">
                <input type="checkbox" id="chk-hardcore" onchange="toggleHardcore()">
                <span class="hardcore-label">–•Ã∂–êÃ∂–†Ã∂–îÃ∂–öÃ∂–ûÃ∂–†Ã∂ ü©∏</span>
            </label>
            
            <label class="checkbox-wrapper">
                <input type="checkbox" id="chk-override">
                <span class="override-label">–Ø –∑–Ω–∞—é —á—Ç–æ –¥–µ–ª–∞—é (–æ—Ç–∫–ª. –ø—Ä–æ–≤–µ—Ä–∫—É)</span>
            </label>
        </div>

        <div class="error-msg" id="error-box">
            –û–®–ò–ë–ö–ê: –°–£–ú–ú–ê –°–í–û–ë–û–î–ù–´–• –û–ß–ö–û–í –î–û–õ–ñ–ù–ê –ë–´–¢–¨ 0!
        </div>

        <div style="text-align: center; margin-bottom: 50px;">
            <button class="btn-copy" onclick="generateAndCopy()">–°–ö–û–ü–ò–†–û–í–ê–¢–¨ –ê–ù–ö–ï–¢–£</button>
            <a href="https://discord.com/channels/1119006900831396001/1153404649605435452" target="_blank" class="discord-link">–ü–µ—Ä–µ–π—Ç–∏ –≤ Discord –∫–∞–Ω–∞–ª</a>
        </div>
    </div>
</section>

<script>
    // ================= –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø =================
    // –°—Ç–∞—Ä—Ç–æ–≤—ã–µ –æ—á–∫–∏ –¥–ª—è –æ–±—ã—á–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞
    const START_PHYS = 3;
    const START_SKILL = 4;
    
    // –°—Ç–∞—Ä—Ç–æ–≤—ã–µ –æ—á–∫–∏ (–¥–µ—Ñ–∏—Ü–∏—Ç) –¥–ª—è –•–∞—Ä–¥–∫–æ—Ä–∞
    const HARDCORE_PHYS = -3;
    const HARDCORE_SKILL = -4;

    let currentPhysPool = START_PHYS;
    let currentSkillPool = START_SKILL;
    
    const BELONGS = [
        { id: 'gleele', title: '–ì–ª–∏–∏–ª–µ—Ü', img: 'https://placehold.co/275x130/222/fff?text=gleele', desc: '–í—ã –∂–∏—Ç–µ–ª—å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–ø–ª–æ—Ç–∞ –∏—Å—Ç–∏–Ω–Ω–æ–π –¥–µ–º–æ–∫—Ä–∞—Ç–∏–∏, –ø—Ä–æ—Ä–≤–∞–≤—à–∏–π—Å—è —Å–∫–≤–æ–∑—å –±—é—Ä–æ–∫—Ä–∞—Ç–∏—é –∏ –≥—Ä–∞–∂–¥–∞–Ω—Å–∫–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –∫ –ø–æ—Ä–æ–≥—É –Ω–∞—á–∞–ª–∞ —Å–≤–æ–µ–π –∏—Å—Ç–æ—Ä–∏–∏.' },
        { id: 'noble', title: '–ö–æ—Ä–ø–æ—Ä–∞—Ç', img: 'https://placehold.co/275x130/333/fff?text=noble', desc: '–î–æ –Ω–µ–¥–∞–≤–Ω–∞ –≤—ã –±—ã–ª–∏ —á–∞—Å—Ç—å—é –±–µ–∑–∂–∞–ª–æ—Å—Ç–Ω–æ–π, –Ω–æ —Å—Ç–æ–ª—å –ø—Ä–∏—Ç—è–≥–∞—Ç–µ–ª—å–Ω–æ–π —Å–≤–æ–∏–º –±–æ–≥–∞—Ç—Å—Ç–≤–æ–º –∫–∞–ø–∏—Ç–∞–ª–∏—Å—Ç–∏—á–µ—Å–∫–æ–π –º–∞—à–∏–Ω—ã –∞–ª—å—è–Ω—Å–∞ –∫–æ—Ä–ø–æ—Ä–∞—Ü–∏–π Noble Coalition, –Ω–æ —Å–µ–≥–æ–¥–Ω—è –≤—ã —Å—Ç–∞–Ω–µ—Ç–µ –µ—ë —Ä—É–∫–æ–π.' },
        { id: 'klemantis', title: '–ö–ª–µ–º–∞–Ω—Ç–∏–µ—Ü', img: 'https://placehold.co/275x130/444/fff?text=klemantis', desc: '–í—ã –≤—ã—Ä–æ—Å–ª–∏ –≤ –∫–æ–º–º—É–Ω–∏—Å—Ç–∏—á–µ—Å–∫–æ–π —Å–≤–µ—Ä—Ö–¥–µ—Ä–∂–∞–≤–µ –∑–≤–µ—Ä—è–Ω ‚Äî –∏—Å—Ç–∏–Ω–Ω—ã—Ö –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤ —Å–µ–∫—Ç–æ—Ä–∞ –•–∞—è—Ç. –í—ã –∑–Ω–∞–µ—Ç–µ, —á—Ç–æ –Ω–µ—Ç —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π –∂–µ—Ä—Ç–≤—ã –≤–æ –∏–º—è –ø—Ä–æ—Ü–≤–µ—Ç–∞–Ω–∏—è –∏ —Å–µ–≥–æ–¥–Ω—è –ø—Ä–∏—à—ë–ª –¥–µ–Ω—å, —á—Ç–æ–±—ã –ø—Ä–∏–≤—Ä–∞—Ç–∏—Ç—å —Å–≤–æ—é –∏–¥–µ—é –≤ –¥–µ–π—Å—Ç–≤–∏—è.' },
        { id: 'sof', title: '–°–æ–ª–¥–∞—Ç –£–¥–∞—á–∏', img: 'https://placehold.co/275x130/444/fff?text=sof', desc: '–ë–æ–ª–µ–µ –∑–∞ –≤–∞–º–∏ –Ω–µ—Ç –Ω–∏ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏ –Ω–∏ —Ä–æ–¥–∏–Ω—ã. –í—ã ‚Äî —Å–æ–ª–¥–∞—Ç —É–¥–∞—á–∏ –∏ –≤–∞—à–∞ –∂–∏–∑–Ω—å –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —Ü–µ–ª–∏–∫–æ–º –≤ –≤–∞—à–∏—Ö —Ä—É–∫–∞—Ö. –ò–ù–¢–ï–†–ü–û–õ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –≤–∞–º –ø—Ä–∞–≤–æ –Ω–∞ –≤–∞—à—É –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –Ω–æ –ø–æ—Ä–æ–π –∑–∞–∫–æ–Ω –ª–∏—à—å –æ—Ç—è–≥–æ—â–∞–µ—Ç, –µ—Å–ª–∏ –≤—ã –ø–æ–Ω–∏–º–∞–µ—Ç–µ –æ —á—ë–º —è.' },
    ];

    const CLASSES = [
        { id: 'soldier', title: '–°–æ–ª–¥–∞—Ç', img: 'https://placehold.co/400x130/550000/fff?text=SOLDIER', desc: '–ü–µ—Ö–æ—Ç–Ω—ã–π –±–æ–µ—Ü. –ë–æ–π—Ü—ã- –∫–æ—Å—Ç—è–∫ –ª—é–±–æ–π –ø–µ—Ö–æ—Ç–Ω–æ–π –∞—Ä–º–∏–∏. –í —Å–µ–∫—Ç–æ—Ä–µ –•–∞—è—Ç —á–∞—â–µ –¥–æ–±–∏–≤–∞—é—Ç—Å—è —Å–≤–æ–µ–≥–æ —Å–∏–ª–æ–π —á–µ–º —Ö–æ—Ç–µ–ª–æ—Å—å –±—ã.', bg: 'https://placehold.co/1920x1080/550000/fff?text=SOLDIER+BG', skills: ['–°—Ç—Ä–µ–ª—å–±–∞', '–ë–ª–∏–∂–Ω–∏–π –±–æ–π', '–¢–∞–∫—Ç–∏–∫–∞', '–õ–æ–≤–∫–æ—Å—Ç—å', '–¢–æ—á–Ω–æ—Å—Ç—å', '–§–∏–∑. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞'] },
        { id: 'hacker', title: '–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç', img: 'https://placehold.co/400x130/005500/fff?text=HACKER', desc: '–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç—ã –≤—Å–µ–≥–¥–∞ –∞–∫—Ç—É–∞–ª—å–Ω—ã. –û–Ω–∏ –æ–±–ª–∞–¥–∞—é—Ç –ø–æ–ª–µ–∑–Ω—ã–º–∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–º–∏ –∏–ª–∏ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–º–∏ –∑–Ω–∞–Ω–∏—è–º–∏, —Ä–∞—Å—à–∏—Ä—è—é—â–∏–º–∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª –ª—é–±–æ–π –∫–æ–º–∞–Ω–¥—ã.', bg: 'https://placehold.co/1920x1080/005500/fff?text=HACKER+BG', skills: ['–î–µ–¥—É–∫—Ü–∏—è', '–ú–∞—Å—Ç–µ—Ä—Å—Ç–≤–æ', '–ú–µ–¥–∏—Ü–∏–Ω–∞', '–ò–Ω–∂–µ–Ω–µ—Ä–∏—è', '–ö–æ–Ω—Ç—Ä–æ–ª—å', '–¢–µ—Ö. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞'] },
        { id: 'medic', title: '–ü—Ä–µ–∫–æ–≥–Ω–∏—Ç', img: 'https://placehold.co/400x130/000055/fff?text=MEDIC', desc: '–ò–¥–µ–∞–ª—å–Ω—ã–π –ø–∏–ª–æ—Ç –∏–ª–∏ –∂–µ—Ä—Ç–≤–∞ –∫–∞–ø–∏—Ç–∞–ª–∏—Å—Ç–∏—á–µ—Å–∫–æ–π –º–∞—à–∏–Ω—ã? –ö–∞–∫–∞—è —Ä–∞–∑–Ω–∏—Ü–∞? –ü—Ä–µ–∫–æ–≥–Ω–∏—Ç—ã —ç—Ç–æ –º–∞—Å—Ç–µ—Ä–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ—Ä–∞–±–ª—è–º–∏ –æ–¥–Ω–æ–π –ª–∏—à—å —Å–∏–ª–æ–π –º—ã—Å–ª–∏.', bg: 'https://placehold.co/1920x1080/000055/fff?text=MEDIC+BG', skills: ['–ü–∞–º—è—Ç—å', '–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è –≥–∏–±–∫–æ—Å—Ç—å', '–í–æ—Å–ø—Ä–∏—è—Ç–∏–µ', '–°–∏–ª–∞ –≤–æ–ª–∏', '–†–µ–∞–∫—Ü–∏—è', '–•–∞—Ä–∏–∑–º–∞'] },
        { id: 'pilot', title: '–ë–∏–æ–¥–∏—Å—Ç–æ—Ä—Ç–æ—Ä', img: 'https://placehold.co/400x130/555500/fff?text=PILOT', desc: '–ï—Å–ª–∏ –Ω–µ —É—á–∏—Ç—å –º–∞–≥–∏—é —Ç–æ –≤—Å—ë –≤–æ–∫—Ä—É–≥ –±—É–¥–µ—Ç –∫–∞–∑–∞—Ç—Å—è —Ñ–∏–∑–∏–∫–æ–π. –ë–∏–æ–¥–∏—Å—Ç–æ—Ä—Ç–æ—Ä—ã –º–æ–≥—É—Ç –º–∞–Ω–∏–ø—É–ª–∏—Ä–æ–≤–∞—Ç—å —Ç–∫–∞–Ω—å—é –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞-–≤—Ä–µ–º–µ–Ω–∏ —Å –ø–æ–º–æ—â—å—é —Å–≤–æ–∏—Ö —Ç–µ—Ö–Ω–∏–∫.', bg: 'https://placehold.co/1920x1080/555500/fff?text=PILOT+BG', skills: ['–ì–∞—Ä–º–æ–Ω–∏—è', '–¢–µ—Ä–ø–µ–Ω–∏–µ', '–ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å', '–ì–Ω–µ–≤', '–°–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ', '–ü—Ä–æ–Ω–∏—Ü–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å'] }
    ];

    const PHYSICAL_STATS = ['–°–∏–ª–∞', '–í–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å', '–í—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç—å', '–û–±–∞—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å', '–£–¥–∞—á–∞'];
    
    let user = {
        name: "",
        belong: "",
        classId: "",
        className: "",
        stats: {}, 
        skills: {} 
    };

    // ================= –õ–û–ì–ò–ö–ê UI =================

    function submitName() {
        const input = document.getElementById('input-name');
        if(input.value.trim() === "") { alert("–í–≤–µ–¥–∏—Ç–µ –∏–º—è!"); return; }
        user.name = input.value;
        document.getElementById('hazard-loader').style.display = 'block';
        setTimeout(() => { document.getElementById('hazard-bar').style.width = '100%'; }, 50);
        setTimeout(() => {
            input.classList.add('success');
            activateSection('section-belong');
        }, 2200);
    }

    function activateSection(id) {
        document.body.style.overflowY = "auto";
        const section = document.getElementById(id);
        section.classList.add('active');
        section.scrollIntoView({ behavior: 'smooth' });
    }

    // –ë–ï–õ–û–ù–ì
    const belongGrid = document.getElementById('belong-grid');
    BELONGS.forEach(b => {
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
            <div class="card-bg" style="background-image: url('${b.img}')"></div>
            <div class="card-header-img" style="background-image: url('${b.img}')"></div>
            <div class="card-content"><div class="card-title">${b.title}</div><div class="card-desc">${b.desc}</div></div>`;
        card.onclick = () => selectCard('belong', b.id, b.title, card);
        belongGrid.appendChild(card);
    });
    
    // –î—Ä—É–≥–æ–µ
    const otherCard = document.createElement('div');
    otherCard.className = 'card';
    otherCard.innerHTML = `
         <div class="card-content" style="justify-content: center;">
            <div class="card-title">–î–†–£–ì–û–ï</div>
            <input type="text" id="other-belong-input" placeholder="–í–≤–µ–¥–∏—Ç–µ..." style="width: 80%; font-size: 1rem;" onclick="event.stopPropagation()">
        </div>`;
    otherCard.onclick = () => selectCard('belong', 'other', null, otherCard);
    belongGrid.appendChild(otherCard);

    let selectedBelongCard = null;
    function selectCard(type, id, title, element) {
        if(type === 'belong') {
            if(selectedBelongCard) selectedBelongCard.classList.remove('selected');
            selectedBelongCard = element;
            user.belong = (id === 'other') ? document.getElementById('other-belong-input').value : title;
        } else {
            if(selectedClassCard) selectedClassCard.classList.remove('selected');
            selectedClassCard = element;
            user.classId = id;
            user.className = title;
        }
        element.classList.add('selected');
    }

    function submitBelong() {
        if(selectedBelongCard && selectedBelongCard.querySelector('#other-belong-input')) {
             user.belong = document.getElementById('other-belong-input').value;
        }
        if(!user.belong) { alert("–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏–µ!"); return; }
        activateSection('section-class');
    }

    // –ö–õ–ê–°–°
    const classGrid = document.getElementById('class-grid');
    let selectedClassCard = null;
    CLASSES.forEach(c => {
        const card = document.createElement('div');
        card.className = 'card wide';
        card.innerHTML = `
            <div class="card-bg" style="background-image: url('${c.img}')"></div>
            <div class="card-header-img" style="background-image: url('${c.img}')"></div>
            <div class="card-content"><div class="card-title">${c.title}</div><div class="card-desc">${c.desc}</div></div>`;
        card.onclick = () => selectCard('class', c.id, c.title, card);
        classGrid.appendChild(card);
    });

    function submitClass() {
        if(!user.classId) { alert("–í—ã–±–µ—Ä–∏—Ç–µ –∫–ª–∞—Å—Å!"); return; }
        initStats();
        activateSection('section-stats');
    }

    // –°–¢–ê–¢–ò–°–¢–ò–ö–ê
    function initStats() {
        const clsObj = CLASSES.find(c => c.id === user.classId);
        document.getElementById('stats-bg').style.backgroundImage = `url('${clsObj.bg}')`;
        document.getElementById('final-header').innerText = `${user.name} | ${user.className} | ${user.belong}`;

        PHYSICAL_STATS.forEach(s => user.stats[s] = 0);
        clsObj.skills.forEach(s => user.skills[s] = 0);

        renderStats();
    }

    function renderStats() {
        renderStatsGroup('phys-list', user.stats, updatePhysPool);
        renderStatsGroup('skills-list', user.skills, updateSkillsPool);
        updatePhysPool();
        updateSkillsPool();
    }

    function renderStatsGroup(containerId, dataObj, updateFunc) {
        const container = document.getElementById(containerId);
        container.innerHTML = '';
        for (const [key, value] of Object.entries(dataObj)) {
            const row = document.createElement('div');
            row.className = 'stat-row';
            let barHtml = '';
            for(let i = -4; i <= 4; i++) {
                let cls = 'bar-segment';
                let active = false;
                if(value < 0 && i < 0 && i >= value) active = true; 
                if(value > 0 && i > 0 && i <= value) active = true;
                if(active && i < 0) cls += ' neg';
                if(active && i > 0) cls += ' pos';
                if(i===0) cls = 'bar-segment zero'; 
                barHtml += `<div class="${cls}"></div>`;
            }
            row.innerHTML = `
                <div class="stat-header"><strong>${key}</strong></div>
                <div class="stat-control">
                    <div class="stat-bar">${barHtml}</div>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <button class="stat-btn" onclick="changeStat('${containerId}', '${key}', -1)">-</button>
                        <span class="stat-value-display">${value}</span>
                        <button class="stat-btn" onclick="changeStat('${containerId}', '${key}', 1)">+</button>
                    </div>
                </div>`;
            container.appendChild(row);
        }
    }

    window.changeStat = function(containerId, key, delta) {
        const targetObj = (containerId === 'phys-list') ? user.stats : user.skills;
        const updateFunc = (containerId === 'phys-list') ? updatePhysPool : updateSkillsPool;
        const newVal = targetObj[key] + delta;
        if(newVal < -4 || newVal > 4) return;
        targetObj[key] = newVal;
        renderStatsGroup(containerId, targetObj, updateFunc);
        updateFunc();
    }

    function updatePhysPool() {
        const sum = Object.values(user.stats).reduce((a, b) => a + b, 0);
        const remaining = currentPhysPool - sum;
        const el = document.getElementById('pool-phys-val');
        el.innerText = remaining;
        el.style.color = (remaining === 0) ? 'var(--accent-green)' : 'var(--accent-red)';
        document.getElementById('col-phys').classList.toggle('balanced', remaining === 0);
    }

    function updateSkillsPool() {
        const sum = Object.values(user.skills).reduce((a, b) => a + b, 0);
        const remaining = currentSkillPool - sum;
        const el = document.getElementById('pool-skills-val');
        el.innerText = remaining;
        el.style.color = (remaining === 0) ? 'var(--accent-green)' : 'var(--accent-red)';
        document.getElementById('col-skills').classList.toggle('balanced', remaining === 0);
    }

    // –õ–û–ì–ò–ö–ê –ß–ï–ö–ë–û–ö–°–û–í
    function toggleHardcore() {
        const isHardcore = document.getElementById('chk-hardcore').checked;
        
        // –°–±—Ä–æ—Å –≤—Å–µ—Ö —Å—Ç–∞—Ç–æ–≤
        for (let k in user.stats) user.stats[k] = 0;
        for (let k in user.skills) user.skills[k] = 0;

        if (isHardcore) {
            currentPhysPool = HARDCORE_PHYS;
            currentSkillPool = HARDCORE_SKILL;
        } else {
            currentPhysPool = START_PHYS;
            currentSkillPool = START_SKILL;
        }
        renderStats();
    }

    function generateAndCopy() {
        const physSum = Object.values(user.stats).reduce((a,b)=>a+b,0);
        const skillSum = Object.values(user.skills).reduce((a,b)=>a+b,0);
        
        const physRem = currentPhysPool - physSum;
        const skillRem = currentSkillPool - skillSum;
        const isOverride = document.getElementById('chk-override').checked;
        const isHardcore = document.getElementById('chk-hardcore').checked;

        const errorBox = document.getElementById('error-box');
        
        if(!isOverride && (physRem !== 0 || skillRem !== 0)) {
            document.getElementById('error-sound').play().catch(()=>{});
            errorBox.style.display = 'block';
            return;
        }
        
        errorBox.style.display = 'none';

        let text = `# ${user.name}\n`;
        text += `## ${user.className}\n`;
        text += `## ${user.belong}\n\n`;
        
        if(isHardcore) text += `üíÄ **–†–ï–ñ–ò–ú: –•–ê–†–î–ö–û–†**\n`;
        if(isOverride) text += `‚ö†Ô∏è **–†–ï–ñ–ò–ú: –ê–í–¢–û-–í–ê–õ–ò–î–ê–¶–ò–Ø –û–¢–ö–õ–Æ–ß–ï–ù–ê**\n`;
        
        text += `\n–û–ø–∏—Å–∞–Ω–∏–µ –∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä: –°–¢–ï–†–ï–¢–¨ –ò –°–û–°–¢–ê–í–ò–¢–¨ –°–ê–ú–û–°–¢–û–Ø–¢–ï–õ–¨–ù–û –ü–ï–†–ï–î –û–¢–ü–†–ê–í–ö–û–ô\n\n`;
        text += `–ü—Ä–µ–¥—ã—Å—Ç–æ—Ä–∏—è: –°–¢–ï–†–ï–¢–¨ –°–û–°–¢–ê–í–ò–¢–¨ –°–ê–ú–û–°–¢–û–Ø–¢–ï–õ–¨–ù–û –ü–ï–†–ï–î –û–¢–ü–†–ê–í–ö–û–ô\n\n`;
        
        text += `–§–∏–∑–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:\n`;
        for(const [k, v] of Object.entries(user.stats)) text += `> - [${k}] "${v}"\n`;

        text += `\n–ù–∞–≤—ã–∫–∏:\n`;
        for(const [k, v] of Object.entries(user.skills)) text += `> - [${k}] "${v}"\n`;

        navigator.clipboard.writeText(text).then(() => {
            const btn = document.querySelector('.btn-copy');
            const originalText = btn.innerText;
            btn.innerText = "–°–ö–û–ü–ò–†–û–í–ê–ù–û!";
            btn.style.background = "#fff";
            setTimeout(() => {
                btn.innerText = originalText;
                btn.style.background = "var(--accent-green)";
            }, 2000);
        });
    }
</script>

</body>
</html>
